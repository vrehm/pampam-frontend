<template>
  <!-- # Card that appears after hero section disapear OR after a certain scroll distance. 
    # replicate the handlescroll methods used in TheNavBar component
# Visible only with lg breakpoint
    # hidden lg:visible
# Title & Author
# position 
 # used the fixed class  -->
  <div>
    <transition name="fade" enter-active-class="duration-200 ease-out" enter-class="opacity-0 scale-95" enter-to-class="opacity-100 scale-100" leave-active-class="duration-100 ease-in" leave-class="opacity-100 scale-100" leave-to-class="opacity-0 scale-95">
      <div v-show="flyingCardOpened" class="invisible lg:visible fixed inset-y-0 left-1/12 flex flex-col justify-center">
        <nuxt-link :to="{ name: 'journal' }" class="pb-6 border-b border-gray-100">
          <!-- <h3 class="text-lg leading-tight font-medium text-gray-900">Journal de Pampam</h3> -->
          <!-- journal manuscrit-style svg -->
          <svg class="h-10" viewBox="0 0 299 149" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path
              d="M85.152 90.937c.768-2.082 1.788-3.448 1.71-5.206-1.346-.162-2.084.369-2.852 1.168.148.678.29 1.437.492 2.185.094.405.27.793.65 1.853zm64.835-17.392a9.197 9.197 0 00-4.172 4.476c-2.163 4.759-3.384 9.808-4.393 15.96.906-1.325 1.285-1.784 1.566-2.294 1.862-3.448 3.871-6.832 5.492-10.394a18.085 18.085 0 001.527-7.748h-.02zM67.784 86.687a8.213 8.213 0 00-.925 1.034c-4.073 6.319-6.163 13.328-7.013 20.732a17.993 17.993 0 00.305 6.348c.841 3.498 2.605 5.97 6.377 6.403 4.35-.92 6.956-3.507 8.123-7.703.305-1.093.699-2.146.945-3.276.776-3.532.971-7.166.576-10.761-.52-4.616-.748-9.552-4.974-12.841a4.652 4.652 0 00-3.394.064h-.02zM266.52 56.56c.222-.23.548-.424.646-.7 2.345-6.452 4.7-12.904 6.974-19.381 1.247-3.552 2.37-7.147 3.483-10.741.375-1.208.985-2.464.345-3.774-.72.28-.936.92-1.202 1.511-4.246 9.43-6.895 19.397-9.822 29.264-.364 1.221-.241 2.585-.345 3.881-.6.286-1.033.622-.359 1.354l.28-1.414zM224.215 85.23c-.305.335-.984.57-.32 1.26l.247-1.329.25-.276-.177.345zM123.843 69.67c-1.203 5.22-2.241 10.344-3.577 15.407-1.398 5.29-1.586 10.693-1.832 16.081-.098 2.099.356 4.242.714 6.34a7.7 7.7 0 001.783 3.739 2.004 2.004 0 002.537-1.371c1.522-4.329 4.099-8.17 5.512-12.56 2.158-6.708 4.048-13.481 5.767-20.308.281-1.108.433-2.246.665-3.368.986-4.616 2.611-6.142 7.448-7.128a17.565 17.565 0 004.202-1.34c2.024-.984 4.126-1.038 6.256-.881 3.984.3 6.649 2.956 6.984 6.964a22.368 22.368 0 01-2.335 11.93c-2.335 4.7-4.803 9.33-7.172 14.013a25.475 25.475 0 00-2.783 8.866 4.973 4.973 0 001.236 4.094c3.591 2.058 7.335.985 11.004.349 2.364-.413 3.094-1.152 6.65-5.147.493-1.998 1.172-4.206 1.556-6.457.809-4.35 1.9-8.643 3.266-12.85 1.408-4.567 1.876-9.305 2.27-14.029a9.78 9.78 0 011.566-4.841l3.36-1.764h4.536c3.942-2.388 8.167-4.488 12.994-2.35 1.557 1.094 2.31 2.553 3.172 4.158.302 3.532.114 7.09-.562 10.57-1.477 8.054-3.788 15.929-4.728 24.09-.34 2.956-.72 5.848.227 9.561.532 1.172 1.205 3.291 4.132 3.852 1.428-.118 2.956-1.133 4.497-2.02 1.394-.812 2.58-1.97 3.995-3.108.183-3.536.236-7.141 1.068-10.648.169-.964.4-1.914.689-2.848 2.898-7.653 5.71-15.353 10.344-22.2a33.446 33.446 0 016.946-7.589c2.665-2.099 5.708-3.216 9.176-2.119 1.38.706 2.192 1.971 3.157 3.05a22.996 22.996 0 01-.148 9.314c-.605 2.536-.768 5.178-1.152 7.768-.7 4.708-1.572 9.398-3.152 13.884-1.38 3.912-.917 7.359 1.477 10.838a6.565 6.565 0 004.478-2.607c3.137-3.989 6.782-7.585 9.618-12.56v-3.388c-.117-5.6.73-11.092 1.74-16.576 1.428-7.737 3.546-15.268 5.822-22.815 1.61-5.329 2.837-10.776 4.585-16.057 2.316-6.988 4.788-13.95 8.867-20.195 3.25-4.949 4.265-5.748 10.137-7.953 1.704-.227 3.191.59 4.783.9 3.221 3.197 4.092 6.896 3.3 11.284-1.346 7.448-3.739 14.565-6.32 21.633-2.079 5.699-4.326 11.33-6.266 17.078-2.956 8.713-6.722 17.081-10.205 25.568-1.552 3.777-3.616 7.349-5.468 11.053-.625 4.483 1.271 8.375 3.349 12.063 1.755 3.102 4.558 4.901 8.556 4.684 5.163-.276 9.93-2.004 14.778-3.01.773-1.309 1.289-2.536 2.113-3.497.984-1.128 2.403-1.669 3.841-2.172 1.744 0 3.094.828 4.271 2.108 1.079 1.852.891 3.713 0 5.616-.892 1.901-1.971 3.447-3.907 4.22-1.512.621-3.014 1.369-4.594 1.696-4.478.915-8.867 2.461-13.531 2.299-.956-.028-1.921.35-3.212.606-2.408-.645-5.084-1.4-7.772-2.084-4.379-1.108-7.537-3.782-9.852-7.554-.596-.986-1.024-2.064-2.245-2.706-1.518.302-2.296 1.744-3.07 2.819-2.704 3.757-6.274 6.161-10.677 7.683-2.912.572-5.488-2.176-8.349-.892l-4.187-2.915c-2.035.335-3.247 1.837-5.296 2.763-1.969.738-4.033 0-5.851-1.478-2.113 1.552-4.088 3-6.058 4.432-1.882 1.395-4.079 2.064-6.26 2.784a7.195 7.195 0 01-3.891.222c-3.025-.71-6.035-1.508-8.991-2.463a5.999 5.999 0 01-3.28-2.856c-1.378-2.435-2.634-4.901-2.753-7.799a46.62 46.62 0 01.788-10.728c1.479-7.722 3.276-15.356 4.927-23.036.181-.842.492-1.886-.602-2.817-2.925 3.941-5.512 7.832-6.344 12.964-1.546 9.51-2.729 19.077-4.369 28.568-.197 1.143-.34 2.271-.941 3.28-.516.861-1.147 1.596-2.304 1.572-1.868-.689-1.528-2.739-2.463-4.079l-1.74 1.971c-1.413.733-2.413-.123-3.531-.385-.473.086-.94.2-1.398.34a26.483 26.483 0 01-17.811.241 17.192 17.192 0 00-2.345-.728c-3.33-.576-5.532-2.645-7.266-5.359-.245-.384-.457-.798-.68-1.188-1.364.335-1.102 1.547-1.422 2.37a22.725 22.725 0 00-.68 2.862c-.492 1.906-.94 3.811-2.724 4.827-2.58-.201-1.822-2.503-2.838-3.971-1.512 1.143-2.733 2.75-4.614 3.316a8.91 8.91 0 01-4.01.178c-.329-.199-.764-.42-1.162-.7-.399-.282-.759-.622-1.128-.927-1.439-.463-2.98.345-4.148-.329-1.33-.572-1.97-1.552-2.688-2.434-.626-.754-1.286-1.478-1.931-2.221-1.435.369-1.971 1.715-2.911 2.585a16.701 16.701 0 01-5.418 3.33c-1.616.632-3.414.912-4.768.034-2.242-1.477-4.71-1.216-6.739-1.561-2.236-.847-3.265-2.689-4.792-3.715-1.177.183-1.335 1.042-1.587 1.799-.738 2.207-2.009 4.133-3.289 6.028-2.837 4.193-6.925 6.404-11.89 6.956-1.44.157-3.123.221-4.354-.375-2.292-1.113-4.773-1.113-7.227-1.852-5.758-3.408-7.88-8.79-7.753-15.298.148-7.679 2.43-14.846 5.684-21.672 2.035-4.271 4.217-8.502 7.32-12.187a24.995 24.995 0 014.684-4.295c3.33-2.364 6.95-3.704 11.26-2.349a8.607 8.607 0 013.079 2.892c.71 1.072 1.261 2.25 1.97 3.59 2.7-.537 4.926-1.882 7.152-3.167 1.56-.896 3.112-1.812 4.68-2.699 1.566-.887 3.082-1.04 5.111-.463l2.183 2.404c.448 2.25-.538 3.832-1.478 5.344a61.864 61.864 0 00-7.477 18.082c-1.221 4.896-.985 9.728 1.419 13.933 1.064.987 1.97 1.263 3.152.987 1.68-.902 2.877-2.464 3.822-4.192a64.32 64.32 0 006.368-16.467c1.163-5.113 2.192-10.255 3.448-15.339.631-2.516 1.134-5.157 3.015-7.358 1.591-1.355 3.448-2.2 5.911-1.476 1.166.541 2.088 1.428 2.901 3.038zM14.761 148.832L4.28 146.369c-3.114-3.018-3.33-6.896-3.335-10.585a35.456 35.456 0 011.477-9.191c2.134-7.881 4.282-15.796 6.946-23.549 1.645-4.796 3.26-9.595 5.32-14.284a13.879 13.879 0 014.96-3.73c1.108-.28 1.97.203 3.113.657l1.97 2.753c-.171.93-.397 1.85-.675 2.753-1.518 4.148-3.167 8.25-4.626 12.418-3.733 10.678-7.004 21.485-8.594 32.913.122.492.265 1.113.448 1.732.182.621.404 1.217.586 1.755.492 0 .862.118 1.088 0 2.148-1.306 3.744-3.192 5.094-5.251 5.6-8.503 10.598-17.264 14.046-26.953 3.355-9.427 6.375-18.944 8.867-28.608 2.177-8.372 3.861-16.903 5.759-25.36 1.605-7.192 3.225-14.378 4.786-21.58.862-3.98 1.602-7.984 2.331-11.62-.685-1.438-1.73-.492-1.936-.65-1.11-.984-1.247-1.797-1.04-2.605.39-1.527.892-3.024 1.448-4.857-4.028-.216-7.319 1.566-10.836 1.97-3.399.41-6.748 1.194-10.117 1.808l-2.24-1.877c-1.755-.521-3.543.987-5.454-.33l2.01-3.625c1.822-1.541 3.812-1.797 5.724-2.201C38.788 6.72 46.126 5.115 53.52 3.71 59.608 2.553 65.608.873 71.868.68c1.684-.053 3.261 0 4.733.847 1.625 2.272 1.605 2.281 1.753 4.927a4.286 4.286 0 01-1.969 2.417 16.358 16.358 0 00-9.58.34c-1.256 1.307-.956 2.71-1.217 3.941-1.448 6.895-2.886 13.79-4.355 20.652-1.777 8.326-3.521 16.655-5.392 24.954-3.636 16.14-7.364 32.257-12.965 47.877a147.005 147.005 0 01-16.959 33.163c-1.872 2.748-4.359 4.886-6.763 7.113-1.122 1.049-2.532 1.511-4.393 1.92z"
              fill="#000"
            />
          </svg>
          <div class="mt-4 text-xs leading-5">
            <div class="font-normal text-gray-500 leading-tight">
              {{ count }} articles
              <span class="font-medium text-gray-900">
                Ã  parcourir
              </span>
            </div>
          </div>
        </nuxt-link>
      </div>
    </transition>
  </div>
</template>

<script>
export default {
  props: {
    article: {
      type: Object,
      required: true
    }
  },
  async fetch() {
    const {
      defaults: { baseURL }
    } = this.$axios

    const articlesCount = await this.$axios.$get(baseURL + `/articles/count`)
    this.count = articlesCount
  },
  data() {
    return {
      count: 0,
      flyingCardOpened: false
    }
  },
  beforeMount() {
    window.addEventListener('scroll', this.handleScroll)
  },
  beforeDestroy() {
    window.removeEventListener('scroll', this.handleScroll)
  },
  methods: {
    handleScroll() {
      // actions on scroll or touchmove events
      if (window.scrollY < 200 || window.innerHeight + window.scrollY >= document.body.scrollHeight - 200) {
        this.flyingCardOpened = false
      } else {
        this.flyingCardOpened = true
      }
    }
  }
}
</script>

<style></style>
